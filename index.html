<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SUMATE Cochabamba | Obras Ejecutadas Gestión 2021-2026</title>
    <link rel="icon" href="img/favicon.png" type="image/png">
    
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />

    <style>
        :root {
            --primary-purple: #4a148c;
            --secondary-red: #b71c1c;
            --gradient-sidebar: linear-gradient(180deg, #4a148c 0%, #b71c1c 100%);
            --white: #ffffff;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Montserrat', sans-serif; overflow: hidden; height: 100vh; display: flex; flex-direction: column; }

        /* --- Header Responsivo --- */
        header {
            background: var(--white);
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            z-index: 1100;
        }

        .btn-menu {
            display: none;
            background: var(--primary-purple);
            color: white;
            border: none;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
        }

        /* --- Contenedor Principal --- */
        .wrapper { display: flex; flex: 1; position: relative; overflow: hidden; }

        /* --- Sidebar Adaptable --- */
        #sidebar {
            width: 350px;
            background: var(--gradient-sidebar);
            color: white;
            display: flex;
            flex-direction: column;
            padding: 25px;
            transition: var(--transition);
            z-index: 1050;
            overflow-y: auto;
            box-shadow: 5px 0 15px rgba(0,0,0,0.2);
        }

        .authority-section { text-align: center; margin-bottom: 25px; }
        .authority-img {
            width: 200px; height: 200px;
            border-radius: 60%;
            border: 4px solid rgba(255,255,255,0.3);
            object-fit: cover;
            margin-bottom: 10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }

        /* --- Filtros Estilizados --- */
        .filter-box {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .filter-box h3 { font-size: 0.9rem; margin-bottom: 15px; text-transform: uppercase; letter-spacing: 1px; }

        .form-control { margin-bottom: 15px; }
        .form-control label { display: block; font-size: 0.75rem; margin-bottom: 5px; opacity: 0.9; }
        .form-control input, .form-control select {
            width: 100%;
            padding: 12px;
            border-radius: 8px;
            border: none;
            background: white;
            color: #333;
            font-weight: 500;
        }

        /* --- Mapa --- */
        #map { flex: 1; transition: var(--transition); }

        /* --- Media Queries (Adaptabilidad) --- */
        @media (max-width: 1024px) {
            #sidebar { width: 350px; }
        }

        @media (max-width: 1024px) {
            .btn-menu { display: block; }
            #sidebar {
                position: absolute;
                left: -100%;
                width: 65%;
                height: 100%;
            }
            #sidebar.active { left: 0; }
            header h1 { font-size: 1rem; }
        }

        @media (min-width: 1920px) { /* Pantallas 4K o 32" */
            #sidebar { width: 450px; padding: 40px; }
            .authority-img { width: 180px; height: 180px; }
            .form-control input { padding: 18px; font-size: 1.1rem; }
            header { height: 80px; }
        }

        /* --- Footer --- */
        footer {
            background: #1a1a1a;
            color: #777;
            padding: 10px 20px;
            font-size: 0.7rem;
            text-align: center;
            z-index: 1100;
        }

        /* Popups */
        .custom-popup .leaflet-popup-content-wrapper {
            background: #fff;
            color: #333;
            border-radius: 12px;
            padding: 5px;
        }
    </style>
</head>
<body>

<header>
    <button class="btn-menu" onclick="toggleSidebar()"><i class="fas fa-bars"></i></button>
    <div style="display: flex; align-items: center; gap: 15px;">
        <img src="img/cmon/sumate_bla.png" alt="Logo" style="height: 120px;">
        
        <h1 style="color: var(--primary-purple); font-weight: 700;"> OBRAS  EJECUTADAS EN COCHABAMBA</h1>
    </div>
</header>

<div class="wrapper">
    <aside id="sidebar">
        <div class="authority-section">
            <img src="img/cmon/manfred.png" alt="Autoridad" class="authority-img">
            <h1 style="font-size: 1.2rem;">Manfred Reyes Villa</h1>
            <h2 style="font-size: 1.2rem;">Gestión Municipal</h2>
            <p style="font-size: 0.8rem; opacity: 0.8;">2021 - 2026</p>
        </div>

        <div class="filter-box">
            <h3><i class="fas fa-search"></i> Busqueda de Obra</h3>
            
            <div class="form-control">
                <label>Nombre de la Obra</label>
                <input type="text" id="nameFilter" placeholder="Ej: Paso a desnivel Av. Peru..." onkeyup="applyFilters()">
            </div>

            <div class="form-control">
                <label>Año de Gestión</label>
                <select id="yearFilter" onchange="applyFilters()">
                    <option value="">Todos los años</option>
                    <option value="2021">2021</option>
                    <option value="2022">2022</option>
                    <option value="2023">2023</option>
                    <option value="2024">2024</option>
                    <option value="2025">2025</option>
                </select>
            </div>

            <div class="form-control">
                <label>Categoría</label>
                <select id="typeFilter" onchange="applyFilters()">
                    <option value="">Todas las categorías</option>
                    <option value="Salud">Salud</option>
                    <option value="Deportes">Deportes</option>
                    <option value="Educación">Educación</option>
                    <option value="Vial">Vial</option>
                    <option value="Comercial">Comercial</option>
                    <option value="AreasVerdes">Areas Verdes</option>
                </select>
            </div>
            
            <button onclick="toggleSidebar()" class="btn-menu" style="display:none; width:100%; margin-top:10px;">Aplicar y Cerrar</button>
        </div>


    </aside>

    <div id="map"></div>
</div>

<footer>Cochabamba
    SUMATE  &copy; 2026 - Sistema de Seguimiento Georreferenciado de OBRAS
</footer>

<script src="js/mun.js"></script>
<script src="js/dis.js"></script>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://unpkg.com/leaflet.markercluster@1.4.1/dist/leaflet.markercluster.js"></script>

<script>
    
    
    
    
    // Configuración del Mapa
    const map = L.map('map', { zoomControl: false }).setView([-17.4223, -66.1674], 12);
    L.control.zoom({ position: 'bottomright' }).addTo(map);

var municipioss = L.geoJSON(muni);
var distritoss = L.geoJSON(distri).addTo(map);

    var layers = {
       "Municipios" : municipioss,
       "Distritos" : distritoss
    }
    L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png').addTo(map);

    const markersCluster = L.markerClusterGroup();
    let  obrasBase = [
        {
            id: 1,
            nombre: "Hospital del Sud - Segunda Fase",
            tipo: "Salud",
            gestion: "2022",
            lat: -17.4355,
            lng: -66.1492,
            color: "#b71c1c", // Rojo Institucional
            icon: "fa-hospital",
            descripcion: "Ampliación de salas de internación y equipamiento médico especializado.",
            imagen: "https://images.unsplash.com/photo-1587351021759-3e566b6af7cc?auto=format&fit=crop&w=400",
            video: "https://www.w3schools.com/html/mov_bbb.mp4"
        },
        {
            id: 2,
            nombre: "Distribuidor Viaducto Blanco Galindo",
            tipo: "Vial",
            gestion: "2023",
            lat: -17.3940,
            lng: -66.1820,
            color: "#333333", // Gris Oscuro para vialidad
            icon: "fa-road",
            descripcion: "Solución vial para descongestionar el tráfico vehicular hacia Quillacollo.",
            imagen: "https://images.unsplash.com/photo-1545147986-a9d6f210df77?auto=format&fit=crop&w=400",
            video: "#"
        },
        {
            id: 3,
            nombre: "Unidad Educativa Modelo Itocta",
            tipo: "Educación",
            gestion: "2021",
            lat: -17.4580,
            lng: -66.1350,
            color: "#4a148c", // Morado Institucional
            icon: "fa-graduation-cap",
            descripcion: "Nueva infraestructura con laboratorios y salas audiovisuales para 500 estudiantes.",
            imagen: "https://images.unsplash.com/photo-1509062522246-3755977927d7?auto=format&fit=crop&w=400",
            video: "#"
        },
        {
            id: 4,
            nombre: "Centro de Salud Alalay",
            tipo: "Salud",
            gestion: "2024",
            lat: -17.4120,
            lng: -66.1320,
            color: "#b71c1c",
            icon: "fa-hospital",
            descripcion: "Mejoramiento de infraestructura y atención 24 horas para la zona sudeste.",
            imagen: "https://images.unsplash.com/photo-1519494026892-80bbd2d6fd0d?auto=format&fit=crop&w=400",
            video: "#"
        },
        {
            id: 5,
            nombre: "Complejo Deportivo Petrolero",
            tipo: "Deportes",
            gestion: "2022",
            lat: -17.4250,
            lng: -66.1550,
            color: "#2e7d32", // Verde para deportes
            icon: "fa-running",
            descripcion: "Revitalización de campos deportivos con césped sintético e iluminación LED.",
            imagen: "https://images.unsplash.com/photo-1526232761682-d26e03ac148e?auto=format&fit=crop&w=400",
            video: "#"
        },
        {
            id: 6,
            nombre: "Pasarela Peatonal Recoleta",
            tipo: "Vial",
            gestion: "2023",
            lat: -17.3820,
            lng: -66.1560,
            color: "#333333",
            icon: "fa-walking",
            descripcion: "Mantenimiento preventivo y mejora de iluminación ornamental.",
            imagen: "https://images.unsplash.com/photo-1449034446853-66c86144b0ad?auto=format&fit=crop&w=400",
            video: "#"
        },
        {
            id: 7,
            nombre: "Escuela Municipal de Artes",
            tipo: "Educación",
            gestion: "2025",
            lat: -17.3980,
            lng: -66.1620,
            color: "#4a148c",
            icon: "fa-paint-brush",
            descripcion: "Espacio cultural para la formación técnica en música, danza y artes plásticas.",
            imagen: "https://images.unsplash.com/photo-1513364776144-60967b0f800f?auto=format&fit=crop&w=400",
            video: "#"
        },
        {
            id: 8,
            nombre: "Parque Integración Cochabamba",
            tipo: "Deportes",
            gestion: "2024",
            lat: -17.4420,
            lng: -66.1280,
            color: "#2e7d32",
            icon: "fa-tree",
            descripcion: "Áreas verdes, juegos infantiles y ciclovía perimetral.",
            imagen: "https://images.unsplash.com/photo-1544367567-0f2fcb009e0b?auto=format&fit=crop&w=400",
            video: "#"
        },
        {
            id: 9,
            nombre: "Pavimentación Av. Petrolera Km 7",
            tipo: "Vial",
            gestion: "2021",
            lat: -17.4650,
            lng: -66.1150,
            color: "#333333",
            icon: "fa-road",
            descripcion: "Nueva capa asfáltica y señalización vial para el transporte pesado.",
            imagen: "https://images.unsplash.com/photo-1515162816999-a0c47dc192f7?auto=format&fit=crop&w=400",
            video: "#"
        },
        {
            id: 10,
            nombre: "Mercado San Antonio Nuevo",
            tipo: "Vial",
            gestion: "2023",
            lat: -17.4025,
            lng: -66.1555,
            color: "#6a1b9a",
            icon: "fa-store",
            descripcion: "Modernización de infraestructura comercial y accesos para el ciudadano.",
            imagen: "https://images.unsplash.com/photo-1533900298318-6b8da08a523e?auto=format&fit=crop&w=400",
            video: "#"
        }
    ];


    function renderMarkers(data) {
        markersCluster.clearLayers();
        data.forEach(obra => {
            const icon = L.divIcon({
                html: `<div style="background:${obra.color}; width:35px; height:35px; border-radius:50%; display:flex; align-items:center; justify-content:center; color:white; border:3px solid white; box-shadow:0 3px 6px rgba(0,0,0,0.3)">
                        <i class="fas ${obra.icon}"></i>
                       </div>`,
                className: '',
                iconSize: [35, 35]
            });

            const m = L.marker([obra.lat, obra.lng], { icon: icon });
            m.bindPopup(`
                <div style="width:250px">
                    <h3 style="color:${obra.color}">${obra.nombre}</h3>
                    <hr style="margin:8px 0; opacity:0.2">
                    <p><b>Gestión:</b> ${obra.gestion}</p>
                    <p><b>Tipo:</b> ${obra.tipo}</p>
                    <p><b>Descripcion:</b> ${obra.descripcion}</p>
                    <img src="img/9a.jpg" style="width:100%; border-radius:8px; margin-top:10px">
                    <button style="width:100%; margin-top:10px; background:var(--primary-purple); color:white; border:none; padding:8px; border-radius:5px; cursor:pointer;">Ver FichaTecnica <i class="fas fa-play"></i></button>
                </div>
            `, { className: 'custom-popup' });
            markersCluster.addLayer(m);
        });
        map.addLayer(markersCluster);
    }

    function applyFilters() {
        const name = document.getElementById('nameFilter').value.toLowerCase();
        const year = document.getElementById('yearFilter').value;
        const type = document.getElementById('typeFilter').value;

        const filtered = obrasBase.filter(o => {
            return (o.nombre.toLowerCase().includes(name)) &&
                   (year === "" || o.gestion === year) &&
                   (type === "" || o.tipo === type);
        });
        renderMarkers(filtered);
    }

    function toggleSidebar() {
        document.getElementById('sidebar').classList.toggle('active');
    }

    // Inicialización
    renderMarkers(obrasBase);
</script>

</body>
</html>
